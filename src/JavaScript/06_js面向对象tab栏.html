<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JS面向对象 动态添加tab标签</title>
</head>
<body>
    <!--思考：第一步 抽象对象：Tab对象-->
    <!--1.该对象具有切换功能-->
    <!--2.该对象具有添加功能-->
    <!--3.该对象具有删除功能-->
    <!--4.该对象具有修改功能-->
    <h4>JS面向对象 动态添加标签页</h4>
    <div class="tabsbox" id="tab">
        <!--tab标签-->
        <nav class="firstnav">
            <ul>
                <li class="licative"><span>测试1</span><span class="iconfont icon-guanbi"></span></li>
                <li><span>测试2</span><span class="iconfont icon-guanbi"></span></li>
                <li><span>测试3</span><span class="iconfont icon-guanbi"></span></li>
            </ul>
            <div class="tabadd">
                <span>+</span>
            </div>
        </nav>
        <!--tab内容-->
        <div class="tabscon">
            <section class="conactive">测试1</section>
            <section>测试2</section>
            <section>测试3</section>
        </div>
    </div>
<script>
    var that;//用来存构造函数里面的this 全局变量
    class Tab {
        constructor(id){
            //获取元素
            that = this;
            this.main = document.querySelector(id);
            this.lis = this.main.querySelectorAll('li');
            this.sections = this.main.querySelectorAll('section');
            this.add = this.main.querySelector('.tabadd');
            //li的父元素
            this.ul = this.main.querySelector('.firstnav ul:first-child');
            this.init();
        }
        //初始化 让相关的元素绑定事件
        init(){
            //初始化添加
            this.add.onclick = this.addTab;
            //初始化切换
            for(var i = 0; i < this.lis.length; i++){
                this.lis[i].index = i;
                // this.lis[i].onclick  = function(){
                //     console.log(this.index);
                // }
                this.lis[i].onclick  = this.toggleTab;//this.toggleTab不要写成this.toggleTab() 因为我们需要点击后再调用 直接加()就直接执行这个函数了
            }
        }
        //1.切换功能 点击tab栏可以切换效果
        toggleTab(){//这个里面的this指向它的调用者lis[i]
            //console.log(this.index);//查看是否能够拿到索引号
            that.clearClass();//这里用that调用的clearClass函数
            this.className = 'licative';
            that.sections[this.index].className = 'conactive';//that里面存的构造函数里面的this

        }
        //封装一个清除class函数
        clearClass(){//上面用that掉用这个函数 所以这里的this指向that 没有问题
            for(var i = 0;i < this.lis.length;i++){
                this.lis[i].className = '';
                this.sections[i].className = '';
            }
        }
        //2.添加功能 点击加号，可以添加tab项和内容项
        addTab(){
            //以前的做法：动态创建元素createElement，但是元素里面内容较多 需要innerHTML赋值，再appendChild追加到父元素里面
            //现在高级做法：利用insertAdjacentHTML()可以直接把字符串格式元素添加到父元素中
            //appendChild不支持追加字符串的子元素，insertAdjacentHTML支持
            //(1)创建新的选项卡li和新的内容section
            var li = '<li><span>新选项卡</span><span class="iconfont icon-guanbi"></span></li>';
            //(2)把创建好的两个元素追加到对应的父元素中
            that.ul.insertAdjacentHTML('beforeend',li);
            //注意：element.insertAdjacentHTML(position,text);
            //'beforebegin':元素自身的前面
            //'afterbegin'：插入元素内部的第一个子节点之前
            //'beforeend':插入元素内部的最后一个子节点之后  有点类似于appendChild追加到父元素的最后面
            //'afterend'：元素自身的后面
            //text:是要被解析为html或xml 并插入到DOM树中的字符串
        }

        //3.删除功能 点击X号，可以删除当前的tab项和内容项
        removeTab(){

        }

        //4.修改功能 双击tab项文字或者内容项文字 可以修改里面的文字
        ediTab(){

        }

    }
    var tab = new Tab('#tab');

</script>
</body>
</html>